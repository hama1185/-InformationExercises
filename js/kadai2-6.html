<html>
 <head>
  <title>2週目(6)</title>
  <script type="text/javascript">
    var cookie_element;
    var element;
    function init_data(){
      var presentDay, dd, extime;
      var user_name = prompt("お名前を入力してください","");
      var user_hobby = prompt("ご趣味はなんでしょうか","");
      presentDay = new Date( );
      dd = presentDay.getDate( );
      dd=dd+7;
      presentDay.setDate(dd);
      extime = presentDay.toGMTString();
      setin_cookie("name", user_name);
      setin_cookie("hobby", user_hobby);
      setin_cookie("count", 1);
      
      document.cookie = "expires=" + extime;
    }

    function setin_cookie(key, value){
      var cData = key + "=" + escape(value) +";";
      document.cookie = cData;
    }

    function change_data(){
      element = document.cookie.split("; ");
      var user_hobby = prompt("ご趣味に変更はありますか", search_data("hobby"));
      setin_cookie("hobby", user_hobby);
      setin_cookie("count", (parseInt(search_data("count")) + 1));
    }

    function search_data(key){//keyに対応するvalueを出力する
      var i;
      for(i = 0;i < element.length; i++){
        var index = element[i].indexOf(key);
        if(index != -1){
          break;
        }
      }
      var data = element[i].replace(key + "=","");
      return data;
    }
    
    if(document.cookie == "" || document.cookie == null){
      init_data();
    }
    else{
      change_data();
    }
    element = document.cookie.split("; ");

  </script>
 </head>
 <body>
   
  <script type="text/javascript">
    document.write("　名前:" + search_data("name"));
    document.write("　趣味:" + search_data("hobby"));
    document.write("　訪問回数:" + search_data("count"));
  </script>
 </body>
</html>